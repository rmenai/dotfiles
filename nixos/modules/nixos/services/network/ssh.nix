{
  config,
  lib,
  pkgs,
  ...
}:
let
  cfg = config.features.services.ssh;
in
{
  options.features.services.ssh = {
    enable = lib.mkEnableOption "SSH client configuration";
  };

  config = lib.mkIf cfg.enable {
    programs.ssh = {
      startAgent = true;
      enableAskPassword = true;

      knownHostsFiles = [
        (pkgs.writeText "custom_known_hosts" ''
          github.com ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOMqqnkVzrm0SdG6UOoqKLsabgH5C9okWi0dh2l9GKJl
          github.com ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBEmKSENjQEezOmxkZMy7opKgwFB9nkt5YRrYMjNuG5N87uRgg6CLrbo5wAdT/y6v0mKV0U2w0WZ2YB/++Tpockg=
        '')
      ];

    };

    users.users.${config.spec.user}.extraGroups = [ "git" ];
  };
}
